---
title: 问题汇总
author: xinyu
date: 2024-03-13 16:47:23 +0800
mermaid: true
categories: []
tags: []
---

## 1. 目录未显示

问题说明：Demo 中可以正常显示，但是在项目地址 Clone 并在本地运行 Jekyll serve 指令后无法正常显示目录

解决方案：

经过分析发现，问题在于文件中的`_javascript/modules/components/toc.js`{: .filepath}脚本实际上并未执行，经过代码阅读，其在`_javascript/modules/plugins.js`{: .filepath}脚本中，被统一引用，并在`_javascript/post.js`{: .filepath}脚本中被执行。

因此，面临两个问题

- 代码是否被正常调用
- 代码是否正常工作

在`_layouts/default.html`中`<body>`块末尾添加如下代码后功能正常。

```liquid
    {% if enable_toc %}
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          tocbot.init({
            tocSelector: '#toc',
            contentSelector: '.content',
            ignoreSelector: '[data-toc-skip]',
            headingSelector: 'h2, h3, h4',
            orderedList: false,
            scrollSmooth: false
          });
          tocbot.refresh();
        });
      </script>
    {% endif %}
```

## 2. 修改左下角图标显示

问题说明：左下角默认具有推特、feed 等图标，但是可能有一些并不使用，以及想添加一些非默认的联系方式

解决方案：

修改`_data/contact.yml`{: .filepath}文件中的代码，示例如下。注释并不使用的联系方式类型，保留所需要的。

```yaml
- type: email
  icon: "fas fa-envelope"
  noblank: true # open link in current tab
  url: # Fill with your homepage
```

对于不在示例中的联系方式的填写，需要填写其中的 url，此外其所使用的图标代码来自于 Fontawesome(https://fontawesome.com/)网站。
其中一些常用的网站的图标均有，例如其中 Bilibili 的图标代码则为`fa-brands fa-bilibili`。

## 3. 添加自定义脚注

问题说明：由于图片引用至其它网站，希望。

解决方案：

在`_data/locales/lang.yml`{: .filepath}文件中添加如下代码：

```liquid
  <p>
    {%- capture _ImagesourceURL -%}
      <a href="https://unsplash.com" target="_blank" rel="noopener">unsplash</a>
    {%- endcapture -%}
    {{ site.data.locales[include.lang].ImageSource | replace: ':ImagesourceURL', _ImagesourceURL }}
  </p>
```

在`_include/footer.html`文件中添加如下代码：

```liquid
  <p>
    {%- capture _ImagesourceURL -%}
      <a href="https://unsplash.com" target="_blank" rel="noopener">unsplash</a>
    {%- endcapture -%}
    {{ site.data.locales[include.lang].ImageSource | replace: ':ImagesourceURL', _ImagesourceURL }}
  </p>
```

## 4. 文档更新时间未显示

问题说明：新文档更新时间不显示，示例文档可以正常显示，但复制黏贴一个示例文档的样本，结果为不显示。

测试发现，仅有原文件存在`page.last_modified_at`属性，其它文档均没有该属性，而更新时间是通过输出该属性来显示的，因此对于其它文件而言无法正常显示。

查看`_plugins/posts-lastmod-hook.rb`文件，其代码如下：

```liquid
Jekyll::Hooks.register :posts, :post_init do |post|
  commit_num = `git rev-list --count HEAD "#{ post.path }"`

  if commit_num.to_i > 1
    lastmod_date = `git log -1 --pretty="%ad" --date=iso "#{ post.path }"`
    post.data['last_modified_at'] = lastmod_date
  end
end
```

其中`commit_num`记录了 git 提交次数，其通过是否存在多次 git 提交来判断，但是本项目挂载在 github 上，测试发现即便多次修改提交文件，返回的该变量值仍为 1，因此导致了仅在本地使用`jekyll serve`指令进行本地测试时该参数将为 1，因此不显示更新时间。

## 5. 搜索功能以及侧边栏功能无法正常使用

问题说明：搜索功能无法正常使用，侧边栏无法正常弹出。

解决方案：

在网页中使用 F12 可查看报错信息，显示为：

> `指向“./assets/js/dist/home.min.js”的 <script> 加载失败。`
> {: .prompt-warning }

但是在示例项目中并没有这样的报错，且在侧边栏区域有事件监听器，其来源指向`./assets/js/dist/home.min.js`文件，检查文件夹发现并没有该文件生成。事实上，在`./assets/js/dist`文件夹中仅有`app.min.js`文件存在。生成对应 js 脚本的代码为`roolup.config.js`，部分代码如下：

```liquid
export default [
  build('commons'),
  build('home'),
  build('categories'),
  build('page'),
  build('post'),
  build('misc')
];
```

显然，问题在于本应该执行的 build 指令没有正常执行，需要执行该指令进行安装`npm install -g cross-env`

## 6. 其它

- 免费图标素材网站
